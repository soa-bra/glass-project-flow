# ğŸ—ï¸ Planning Feature Architecture

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

ØªØªØ¨Ø¹ Ù…ÙŠØ²Ø© Ø§Ù„ØªØ®Ø·ÙŠØ· Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø·Ø¨Ù‚Ø§Øª ØµØ§Ø±Ù…Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª ÙˆÙ‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØµÙŠØ§Ù†Ø©.

```
src/features/planning/
â”œâ”€â”€ ui/           â†’ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (React Components)
â”œâ”€â”€ canvas/       â†’ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©
â”œâ”€â”€ elements/     â†’ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù„ÙˆØ­Ø© (MindMap, Diagram, Smart)
â”œâ”€â”€ domain/       â†’ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ (Commands, Policies)
â”œâ”€â”€ state/        â†’ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© (Zustand Slices)
â”œâ”€â”€ integration/  â†’ ØªÙƒØ§Ù…Ù„ Ø®Ø§Ø±Ø¬ÙŠ (Collaboration, Export)
â””â”€â”€ index.ts      â†’ Barrel Export
```

## ğŸ“Š Ù…Ø®Ø·Ø· Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UI Layer                              â”‚
â”‚  (panels, toolbars, overlays, widgets, pages)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ÙŠØ³ØªÙˆØ±Ø¯ Ù…Ù† â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Canvas Layer                             â”‚
â”‚  (viewport, selection, gestures, layers)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ÙŠØ³ØªÙˆØ±Ø¯ Ù…Ù† â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Elements Layer                            â”‚
â”‚  (mindmap, diagram, text, smart)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ÙŠØ³ØªÙˆØ±Ø¯ Ù…Ù† â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     State Layer                              â”‚
â”‚  (store, slices, selectors)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ÙŠØ³ØªÙˆØ±Ø¯ Ù…Ù† â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Domain Layer                              â”‚
â”‚  (types, commands, policies)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”’ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø­ÙˆÙƒÙ…Ø© (Ù…ÙØ±ÙˆØ¶Ø© Ø¨Ù€ ESLint)

| Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© | Ø§Ù„ÙˆØµÙ | Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªØ£Ø«Ø± |
|---------|-------|---------------|
| **UI â‰  Engine** | UI Ù„Ø§ ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† `engine/` Ù…Ø¨Ø§Ø´Ø±Ø© | `ui/**/*` |
| **Engine â‰  React** | Engine Ø®Ø§Ù„ÙŠØ© Ù…Ù† React imports | `engine/**/*` |
| **Slices = Reducers** | State slices Ù„Ø§ ØªØ­ØªÙˆÙŠ business logic | `state/slices/**/*` |
| **Elements â‰  UI** | Elements Ù„Ø§ ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† panels/toolbars | `elements/**/*` |
| **Canvas â‰  Integration** | Canvas Ù„Ø§ ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† integration | `canvas/**/*` |
| **No Legacy** | Ù…Ù…Ù†ÙˆØ¹ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† `components/Planning/` | `**/*` |

## ğŸ“ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª

### UI Layer (`ui/`)
```
ui/
â”œâ”€â”€ panels/      â†’ Ù„ÙˆØ­Ø§Øª Ø¬Ø§Ù†Ø¨ÙŠØ© (Properties, Tools)
â”œâ”€â”€ toolbars/    â†’ Ø£Ø´Ø±Ø·Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª (Bottom, Canvas, Navigation)
â”œâ”€â”€ overlays/    â†’ Ù†ÙˆØ§ÙØ° Ù…Ù†Ø¨Ø«Ù‚Ø© (Dialogs, Popovers)
â”œâ”€â”€ widgets/     â†’ Ù…ÙƒÙˆÙ†Ø§Øª ØµØºÙŠØ±Ø© (Minimap, AI Assistant)
â”œâ”€â”€ PlanningCanvas.tsx
â”œâ”€â”€ PlanningEntryScreen.tsx
â””â”€â”€ PlanningCommandDeck.tsx
```

### Canvas Layer (`canvas/`)
```
canvas/
â”œâ”€â”€ viewport/    â†’ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¹Ø±Ø¶ (InfiniteCanvas, Grid)
â”œâ”€â”€ selection/   â†’ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ (BoundingBox, ResizeHandle)
â”œâ”€â”€ gestures/    â†’ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Pen, Frame, Touch)
â””â”€â”€ layers/      â†’ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø±Ø³Ù… (Snap, Elements)
```

### Elements Layer (`elements/`)
```
elements/
â”œâ”€â”€ mindmap/     â†’ Ø®Ø±Ø§Ø¦Ø· Ø°Ù‡Ù†ÙŠØ© (Node, Connector)
â”œâ”€â”€ diagram/     â†’ Ù…Ø®Ø·Ø·Ø§Øª (VisualNode, Arrow)
â”œâ”€â”€ text/        â†’ Ù†ØµÙˆØµ (Editor, Renderer)
â””â”€â”€ smart/       â†’ Ø¹Ù†Ø§ØµØ± Ø°ÙƒÙŠØ© (Kanban, Gantt, Cards)
```

### State Layer (`state/`)
```
state/
â”œâ”€â”€ slices/      â†’ Zustand slices (elements, viewport, selection)
â”œâ”€â”€ store.ts     â†’ Main store configuration
â”œâ”€â”€ selectors.ts â†’ Memoized selectors
â””â”€â”€ types.ts     â†’ State types
```

### Integration Layer (`integration/`)
```
integration/
â”œâ”€â”€ collaboration/  â†’ ØªØ¹Ø§ÙˆÙ† (Cursors, Sync, Locks)
â”œâ”€â”€ export/         â†’ ØªØµØ¯ÙŠØ± (PDF, Image, JSON)
â”œâ”€â”€ accessibility/  â†’ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„
â”œâ”€â”€ persistence/    â†’ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â””â”€â”€ telemetry/      â†’ ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
```

## âœ… Ø£Ù…Ø«Ù„Ø© ØµØ­ÙŠØ­Ø©

```typescript
// âœ… UI ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† canvas
import { InfiniteCanvas } from '@/features/planning/canvas';

// âœ… UI ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† state
import { useCanvasStore } from '@/stores/canvasStore';

// âœ… Canvas ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† elements
import { SmartElementRenderer } from '@/features/planning/elements';

// âœ… Elements ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† domain
import type { SmartElementType } from '@/types/smart-elements';
```

## âŒ Ø£Ù…Ø«Ù„Ø© Ø®Ø§Ø·Ø¦Ø©

```typescript
// âŒ UI ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† engine Ù…Ø¨Ø§Ø´Ø±Ø©
import { CanvasKernel } from '@/engine/canvas/kernel';
// Ø§Ù„Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ù… canvas/ Ø£Ùˆ hooks

// âŒ Engine ØªØ³ØªÙˆØ±Ø¯ React
import React from 'react';
// Ø§Ù„Ø­Ù„: Engine ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† pure TypeScript

// âŒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…
import { KanbanBoard } from '@/components/Planning/SmartElements';
// Ø§Ù„Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ù… @/features/planning/elements/smart
```

## ğŸ”„ ÙƒÙŠÙÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ©

### Ø¥Ø¶Ø§ÙØ© Ù…ÙƒÙˆÙ† UI Ø¬Ø¯ÙŠØ¯
1. Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…Ù„Ù ÙÙŠ `ui/panels/` Ø£Ùˆ `ui/widgets/`
2. Ø£Ø¶Ù Ø§Ù„ØªØµØ¯ÙŠØ± ÙÙŠ `ui/panels/index.ts`
3. Ø§Ø³ØªÙˆØ±Ø¯Ù‡ Ø¹Ø¨Ø± `@/features/planning/ui`

### Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø°ÙƒÙŠ Ø¬Ø¯ÙŠØ¯
1. Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…Ù„Ù ÙÙŠ `elements/smart/`
2. Ø£Ø¶Ù Ø§Ù„ØªØµØ¯ÙŠØ± ÙÙŠ `elements/smart/index.ts`
3. Ø³Ø¬Ù‘Ù„Ù‡ ÙÙŠ `SmartElementRenderer`

### Ø¥Ø¶Ø§ÙØ© slice Ø¬Ø¯ÙŠØ¯
1. Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…Ù„Ù ÙÙŠ `state/slices/`
2. Ø¯Ù…Ø¬Ù‡ ÙÙŠ `state/store.ts`
3. Ø£Ø¶Ù selectors ÙÙŠ `state/selectors.ts`
